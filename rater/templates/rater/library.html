{% extends "rater/layout.html" %}

{% block title %}Library{% endblock %}

{% block script %}
    <script>
        window.onload = function() {
            // displays stars for each rating 
            document.querySelectorAll(".album-div").forEach(album => {
                rating = parseInt(album.dataset.stars)
                for (let i = 0; i < rating; i++) {
                    // create as many stars as the rating
                    let star = document.createElement('i');
                    star.classList.add('bi-star-fill');
                    album.appendChild(star);
                }
                for (let i = 0; i < (5 - rating); i++) {
                    // add the empty stars to complete 5
                    let star = document.createElement('i');
                    star.classList.add('bi-star');
                    album.appendChild(star);
                }
            })

            // appears/hides album order views depending on select
            document.querySelector("#sort-library").onchange = function() {
                if (this.value == "option-new") {
                    document.querySelector("#cont-new").style.display = 'block';
                    document.querySelector("#cont-old").style.display = 'none';
                    document.querySelector("#cont-high").style.display = 'none';
                    document.querySelector("#cont-low").style.display = 'none';
                }
                else if (this.value == "option-old") {
                    document.querySelector("#cont-new").style.display = 'none';
                    document.querySelector("#cont-old").style.display = 'block';
                    document.querySelector("#cont-high").style.display = 'none';
                    document.querySelector("#cont-low").style.display = 'none';
                }
                else if (this.value == "option-high") {
                    document.querySelector("#cont-new").style.display = 'none';
                    document.querySelector("#cont-old").style.display = 'none';
                    document.querySelector("#cont-high").style.display = 'block';
                    document.querySelector("#cont-low").style.display = 'none';
                }
                else {
                    document.querySelector("#cont-new").style.display = 'none';
                    document.querySelector("#cont-old").style.display = 'none';
                    document.querySelector("#cont-high").style.display = 'none';
                    document.querySelector("#cont-low").style.display = 'block';
                }
            }
        }
    </script>
{% endblock %}

{% block body %}

    <h1>Library</h1>

    <span>Sort by</span>
    <select id="sort-library">
        <option value="option-new">Most recent</option>
        <option value="option-old">Oldest</option>
        <option value="option-high">Highest rated</option>
        <option value="option-low">Lowest rated</option>
    </select>

    <div id="cont-new">
        {% for rating in by_new %}
            <div class="album-div" data-stars="{{ rating.rating }}">
                <img class="album-img" src="{{ rating.album.img }}">
                <h2 class="album-name">{{ rating.album.name }}</h2>
                <h4 class="album-release">{{ rating.album.release }}</h4>
            </div>
        {% endfor %}
    </div>

    <div id="cont-old">
        {% for rating in by_old %}
            <div class="album-div" data-stars="{{ rating.rating }}">
                <img class="album-img" src="{{ rating.album.img }}">
                <h2 class="album-name">{{ rating.album.name }}</h2>
                <h4 class="album-release">{{ rating.album.release }}</h4>
            </div>
        {% endfor %}
    </div>

    <div id="cont-high">
        {% for rating in by_high %}
            <div class="album-div" data-stars="{{ rating.rating }}">
                <img class="album-img" src="{{ rating.album.img }}">
                <h2 class="album-name">{{ rating.album.name }}</h2>
                <h4 class="album-release">{{ rating.album.release }}</h4>
            </div>
        {% endfor %}
    </div>

    <div id="cont-low">
        {% for rating in by_low %}
            <div class="album-div" data-stars="{{ rating.rating }}">
                <img class="album-img" src="{{ rating.album.img }}">
                <h2 class="album-name">{{ rating.album.name }}</h2>
                <h4 class="album-release">{{ rating.album.release }}</h4>
            </div>
        {% endfor %}
    </div>

{% endblock %}